#ifndef UI
#define UI
#include "Pieces.h"

static const float eval_list[6] = {10, 32.5, 35, 50, 90, 900};
static const float eval_positions[12][64] = {{0, 0, 0, 0, 0, 0, 0, 0, -5, -5, -5, -5, -5, -5, -5, -5, -1, -1, -2, -3, -3, -2, -1, -1, -0.5, -0.5, -1, -2.5,
                                               -2.5, -1, -0.5, -0.5, 0, 0, 0, -2, -2, 0, 0, 0, -0.5, 0.5, 1, 0, 0, 1, 0.5, -0.5, -0.5, -1, -1, 2, 2, -1, -1,
                                               -0.5, 0, 0, 0, 0, 0, 0, 0, 0}, // p
                                             {5, 4, 3, 3, 3, 3, 4, 5, 4, 2, 0, 0, 0, 0, 2, 4, 3, 0, -1, -1.5, -1.5, -1, 0, 3, 3, -0.5, -1.5, -2, -2, -1.5,
                                              -0.5, 3, 3, 0, -1.5, -2, -2, -1.5, 0, 3, 3, -0.5, -1, -1.5, -1.5, -1, -0.5, 3, 4, 2, 0, -0.5, -0.5, 0, 2, 4,
                                              5, 4, 3, 3, 3, 3, 4, 5}, // n
                                             {2, 1, 1, 1, 1, 1, 1, 2, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, -0.5, -1, -1, -0.5, 0, 1, 1, -0.5, -0.5, -1, -1, -0.5,
                                              -0.5, 1, 1, 0, -1, -1, -1, -1, 0, 1, 1, -1, -1, -1, -1, -1, -1, 1, 1, -0.5, 0, 0, 0, 0, -0.5, 1, 2, 1, 1, 1,
                                              1, 1, 1, 2}, // b
                                             {0, 0, 0, 0, 0, 0, 0, 0, -0.5, -1, -1, -1, -1, -1, -1, -0.5, 0.5, 0, 0, 0, 0, 0, 0, 0.5, 0.5, 0, 0, 0, 0, 0, 0,
                                              0.5, 0.5, 0, 0, 0, 0, 0, 0, 0.5, 0.5, 0, 0, 0, 0, 0, 0, 0.5, 0.5, 0, 0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5, -0.5,
                                              0, 0, 0}, // r
                                             {2, 1, 1, 0.5, 0.5, 1, 1, 2, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, -0.5, -0.5, -0.5, -0.5, 0, 1, 0, 0, -0.5, -0.5,
                                              -0.5, -0.5, 0, 0, 0, 0, -0.5, -0.5, -0.5, -0.5, 0, 0, 1, 0, 0, -0.5, -0.5, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 2,
                                              1, 1, 0.5, 0.5, 1, 1, 2}, // q
                                             {3, 4, 4, 5, 5, 4, 4, 3, 3, 4, 4, 5, 5, 4, 4, 3, 3, 4, 4, 5, 5, 4, 4, 3, 3, 4, 4, 5, 5, 4, 4, 3, 2, 3, 3, 4, 4,
                                              3, 3, 2, 1, 2, 2, 2, 2, 2, 2, 1, -2, -2, 0, 0, 0, 0, -2, -2, -2, -3, -1, 0, 0, -1, -3, -2}, // k
                                             {0, 0, 0, 0, 0, 0, 0, 0, 0.5, 1, 1, -2, -2, 1, 1, 0.5, 0.5, -0.5, -1, 0, 0, -1, -0.5, 0.5, 0, 0, 0, 2, 2, 0, 0,
                                              0, 0.5, 0.5, 1, 2.5, 2.5, 1, 0.5, 0.5, 1, 1, 2, 3, 3, 2, 1, 1, 5, 5, 5, 5, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0,
                                              0}, // P
                                             {-5, -4, -3, -3, -3, -3, -4, -5, -4, -2, 0, 0.5, 0.5, 0, -2, -4, -3, 0.5, 1, 1.5, 1.5, 1, 0.5, -3, -3, 0, 1.5,
                                              2, 2, 1.5, 0, -3, -3, 0.5, 1.5, 2, 2, 1.5, 0.5, -3, -3, 0, 1, 1.5, 1.5, 1, 0, -3, -4, -2, 0, 0, 0, 0, -2, -4,
                                              -5, -4, -3, -3, -3, -3, -4, -5}, // N
                                             {-2, -1, -1, -1, -1, -1, -1, -2, -1, 0.5, 0, 0, 0, 0, 0.5, -1, -1, 1, 1, 1, 1, 1, 1, -1, -1, 0, 1, 1, 1, 1, 0,
                                              -1, -1, 0.5, 0.5, 1, 1, 0.5, 0.5, -1, -1, 0, 0.5, 1, 1, 0.5, 0, -1, -1, 0, 0, 0, 0, 0, 0, -1, -2, -1, -1, -1,
                                              -1, -1, -1, -2}, // B
                                             {0, 0, 0, 0.5, 0.5, 0, 0, 0, -0.5, 0, 0, 0, 0, 0, 0, -0.5, -0.5, 0, 0, 0, 0, 0, 0, -0.5, -0.5, 0, 0, 0, 0, 0,
                                              0, -0.5, -0.5, 0, 0, 0, 0, 0, 0, -0.5, -0.5, 0, 0, 0, 0, 0, 0, -0.5, 0.5, 1, 1, 1, 1, 1, 1, 0.5, 0, 0, 0, 0,
                                              0, 0, 0, 0}, // R
                                             {-2, -1, -1, -0.5, -0.5, -1, -1, -2, -1, 0, 0, 0, 0, 0, 0, -1, -1, 0, 0, 0.5, 0.5, 0, 0, -1, 0, 0, 0.5, 0.5,
                                              0.5, 0.5, 0, 0, 0, 0, 0.5, 0.5, 0.5, 0.5, 0, 0, -1, 0, 0.5, 0.5, 0.5, 0.5, 0, -1, -1, 0, 0, 0, 0, 0, 0, -1,
                                              -2, -1, -1, -0.5, -0.5, -1, -1, -2}, // Q
                                             {2, 3, 1, 0, 0, 1, 3, 2, 2, 2, 0, 0, 0, 0, 2, 2, -1, -2, -2, -2, -2, -2, -2, -1, -2, -3, -3, -4, -4, -3, -3,
                                              -2, -3, -4, -4, -5, -5, -4, -4, -3, -3, -4, -4, -5, -5, -4, -4, -3, -3, -4, -4, -5, -5, -4, -4, -3, -3, -4,
                                              -4, -5, -5, -4, -4, -3}}; // K

class Board;

class Ui {
public:
    explicit Ui(int color) {to_play = color;};
    void set_pieces(Piece[64], const bool[64]);
    int to_play;
    vector<int> own_pieces;
    bool piece_exists[64]{};
    Piece piece_list[64];
    static void replace(string &str, const string &from, const string &to) {
        size_t start_pos = str.find(from);
        if (start_pos != string::npos) {
            str.replace(start_pos, from.length(), to);
        }
    }


};

class Ascii_ui : public Ui {


public:
    explicit Ascii_ui(int color) : Ui(color) {}
    tuple<bool, int, int, int> move();
};

class Random_ui : public Ui {
public:
    explicit Random_ui(int color) : Ui(color) {};
    tuple<bool, int, int, int> move();
};

class Bot_ui: public Ui {
public:
    explicit Bot_ui(int color, int dep) : Ui(color) {depth = dep;};
    tuple<bool, int, int, int> move();
    void set_board(Board *b) {game = b;};
private:
    Board *game{};
    int depth;
    tuple<int, int, int> best_move_this_iteration;
    //float max_score = -infinityf(), min_score = infinityf();
    tuple<float, int, int, int> min_max(int local_depth, double alpha, double beta, tuple<int,int, int> last_move);
    static float evaluate(Piece *, const bool *);
    vector<tuple<int, int, int>> order_moves(int color);
    float better_min_max(int local_depth, float alpha, float beta);
};
#endif

